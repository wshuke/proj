<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<link rel="icon" type="image/x-icon" href="/static/favicon.ico">
<head>
    <meta charset="UTF-8">
    <script src="/js/jquery-3.3.1.min.js"></script>
    <title>主页</title>

    <script>
        //全局的ajax访问，处理ajax清求时sesion超时
        $.ajaxSetup({
            contentType : "application/x-www-form-urlencoded;charset=utf-8",
            complete : function(XMLHttpRequest, textStatus) {
                var SessionStatus = XMLHttpRequest.getResponseHeader("SessionStatus"); // 通过XMLHttpRequest取得响应头，sessionstatus，
                if (SessionStatus === "timeout") {
                    // 如果超时就处理 ，指定要跳转的页面
                    alert("超时未动作，请重新登录。");
                    window.location.replace("/login.html");
                }
                else if(SessionStatus === "needlogin"){
                    alert("请先登录。");
                    //window.location.replace("/login.html");
                }
            }
        });
    </script>

    <script>

        $(document).ready(function(){

            $(".button1").click(function () {       //Restful,no args
                var url = $(this).val();
                $.getJSON(url, function (json) {
                    $("#display").text(JSON.stringify(json));
                });
            });

            $(".button2").click(function () {   //DynamicRequest
                var url = $(this).val();
                var jsonStr = $("#DRString").val();
                if(jsonStr === "" || jsonStr == null)
                    jsonStr = "{}";
                $.post(url, {DynamicRequest:jsonStr}, function (json) {
                    $("#display").text(JSON.stringify(json));
                });
            });
            $(".button3").click(function () {   //dateBetween
                var url = $(this).val();
                var date1 = "2018-10-26 14:02:00";
                var date2 = "2018-10-26 14:04:00";
                $.getJSON(url, {dateBetween:JSON.stringify({date1:date1, date2:date2})}, function (json) {
                    $("#display").text(JSON.stringify(json));
                });
            });
            $(".button4").click(function () {   //UpLoadData
                var url = $(this).val();
                var jsonStr = $("#UDString").val();
                if(jsonStr === "" || jsonStr == null)
                    jsonStr = "{}";
                $.post(url, {uploadData:jsonStr}, function (json) {
                    $("#display").text(JSON.stringify(json));
                });
            });
            $(".button5").click(function () {   //DynamicRequest
                var url = $(this).val();
                var jsonStr = $("#DRString").val();
                if(jsonStr === "" || jsonStr == null)
                    jsonStr = "{}";
                $.post(url, {DynamicRequest:jsonStr,mp:1}, function (json) {
                    $("#display").text(JSON.stringify(json));
                });
            });
        });
    </script>



</head>


<body>

<h1>欢迎回来！</h1>

<!--<br><p th:text="${userName} + ',当前用户组:' + ${userGroup}"/>
<br>
<a href="/findAllusers">查看用户列表</a>
<br>
-->

<h2>------------------------------------------------------</h2>
<div>
    <h3>User Controller Test</h3>
    <button class="button1" value="/getUserInfo/1">测试/getUserInfo/{id}</button>
    <button class="button2" value="/getUsers">测试/getUsers</button>
    <button class="button5" value="/getUsers">Android测试/getUsers</button>
</div>
<div>
    <h3>Device Controller Test</h3>
    <button class="button1" value="/getDeviceById/1">测试/getDeviceById/{id}</button>
    <button class="button1" value="/getDeviceLatestData/1">测试/getDeviceLatestData/{id}</button>
    <button class="button3" value="/getHistoryDataOfDevice/1">测试/getHistoryDataOfDevice/{id}</button>
    <button class="button1" value="/getDeviceNum/1">测试/getDeviceNum/{typeId}</button>
    <button class="button2" value="/getDevices">测试/getDevices</button>
    <button class="button5" value="/getDevices">Android测试/getDevices</button>
</div>
<div>
    <h3>FaultLog Controller Test</h3>
    <button class="button1" value="/getFaultLogNotClear">测试/getFaultLogNotClear</button>
    <button class="button2" value="/getFaultLogs">测试/getFaultLogs</button>
    <button class="button5" value="/getFaultLogs">Android测试/getFaultLogs</button>
</div>
<div>
    <h3>UpLoadData Controller Test</h3>
    <button class="button4" value="/uploadDataOfDevice/1">测试/uploadDataOfDevice/{id}</button>
</div>
<h2>------------------------------------------------------</h2>
<h3 id="display"></h3>
<h2>------------------------------------------------------</h2>
<div>
    Test DynamicRequest:<input id="DRString" class="input" style="width:100%" value='{"search":"", "equalBy":{"":""}, "sortBy":[{"":"ASC"}], "betweenBy":{"":["",""]},"page":0, "pageSize":10}'>
</div>
<div>
    Test UpLoadData:<input id="UDString" class="input" style="width:100%" value='{"pwd":"", "dJ":[{"val":0,"unit":"","name":""},{"val":0,"unit":"","name":""}], "fTId":0, "fV":0.0}'>
</div>
<br>
<br>
<a href="/login.html">登录</a><a style="margin-left: 20px" href="/registry.html">注册</a>

</body>
</html>